<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>firebase test page</title>
    <style>
      body {
        text-align: center;
      }
      #enterDetails {
        float: left;
        width: 50%;
        background-color: darkslategray;
        color: floralwhite;
      }
      #findDetails {
        float: left;
        width: 50%;
        background-color: floralwhite;
        color: darkslategray;
      }
      input {
        width: 120px;
      }
    </style>
    <script src="https://www.gstatic.com/firebasejs/10.3.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.3.0/firebase-firestore-compat.js"></script>
  </head>
  <body>
    <div class="main">
      <div id="enterDetails">
        <h1>Enter Details</h1>
        <h4>ID</h4>
        <input id="enterID" type="text" />

        <h4>Name</h4>
        <input id="enterName" type="text" />

        <h4>Age</h4>
        <input id="enterAge" type="number" />

        <br /><br />

        <button id="insert">INSERT</button>
        <button id="update">UPDATE</button>
        <button id="remove">REMOVE</button>
        <br /><br />
      </div>

      <div id="findDetails">
        <h1>FIND BY ID</h1>
        <h4>ID</h4>
        <input id="findID" type="text" />
        <button id="find">FIND</button>

        <br /><br />

        <h3 id="findName"></h3>
        <h3 id="findAge"></h3>
      </div>
    </div>

    <script>
      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: 'AIzaSyDeDG3C9i3BZLa8JXGTJcOUCla2rwSskik',
        authDomain: 'test-c81cd.firebaseapp.com',
        projectId: 'test-c81cd',
        storageBucket: 'test-c81cd.appspot.com',
        messagingSenderId: '485320566376',
        appId: '1:485320566376:web:7b148995b1f40879c93ddd',
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      // Initialize Firestore
      const db = firebase.firestore();

      const userRef = db.collection('users');

      userRef
        .get()
        .then((querySnapshot) => {
          querySnapshot.forEach((doc) => {
            console.log(doc.id, ' => ', doc.data());
          });
        })
        .catch((error) => {
          console.log('Error getting documents: ', error);
        });

      const elements = {
        enterID: document.querySelector('#enterID'),
        enterName: document.querySelector('#enterName'),
        enterAge: document.querySelector('#enterAge'),
        findID: document.querySelector('#findID'),
        findName: document.querySelector('#findName'),
        findAge: document.querySelector('#findAge'),
        insertBtn: document.querySelector('#insert'),
        updateBtn: document.querySelector('#update'),
        removeBtn: document.querySelector('#remove'),
        findBtn: document.querySelector('#find'),
      };

      async function getUserById(ID) {
        try {
          return await userRef.where('ID', '==', ID).get();
        } catch (error) {
          console.error('Error getting the user:', error);
        }
      }

      elements.insertBtn.addEventListener('click', async () => {
        const userInfo = {
          ID: elements.enterID.value,
          Name: elements.enterName.value,
          Age: elements.enterAge.value,
        };
        try {
          await userRef.add(userInfo);
          // await userRef.doc('문서이름').set(userInfo);
          console.log('Data successfully set!');
        } catch (error) {
          console.error('Error inserting data:', error);
        }
      });

      elements.findBtn.addEventListener('click', async () => {
        const snapshot = await getUserById(elements.findID.value);

        if (!snapshot.empty) {
          const data = snapshot.docs[0].data();
          elements.findName.textContent = 'Name: ' + data.Name;
          elements.findAge.textContent = 'Age: ' + data.Age;
        } else {
          alert('No data found!');
        }
      });

      elements.updateBtn.addEventListener('click', async () => {
        const snapshot = await getUserById(elements.enterID.value);
        if (!snapshot.empty) {
          snapshot.forEach((doc) => {
            doc.ref.update({
              Name: elements.enterName.value,
              Age: parseInt(elements.enterAge.value, 10),
            });
          });
          console.log('Data successfully updated!');
        } else {
          console.log('No matching document found.');
        }
      });

      elements.removeBtn.addEventListener('click', async () => {
        const snapshot = await getUserById(elements.enterID.value);
        if (!snapshot.empty) {
          snapshot.forEach((doc) => doc.ref.delete());
          console.log('Data successfully deleted!');
        } else {
          console.log('No matching document found.');
        }
      });
    </script>
    <!-- <script src="./test.js"></script> -->
  </body>
</html>

<!-- const enterID = document.querySelector('#enterID'); const enterName = document.querySelector('#enterName'); const enterAge =
document.querySelector('#enterAge'); const findID = document.querySelector('#findID'); const findName = document.querySelector('#findName'); const findAge =
document.querySelector('#findAge'); const insertBtn = document.querySelector('#insert'); const updateBtn = document.querySelector('#update'); const removeBtn =
document.querySelector('#remove'); const findBtn = document.querySelector('#find'); async function handleInsertBtn() { const enteredUserInfo = { ID:
enterID.value, Name: enterName.value, Age: enterAge.value }; try { // await userRef.doc(enterName.value).set(enteredUserInfo); await
userRef.add(enteredUserInfo); console.log('Data successfully set!'); } catch (error) { console.error('Error Getting Users : ', error); } } function
handleFindBtn() { userRef .where('ID', '==', findID.value) .get() .then((snapshot) => { if (!snapshot.empty) { snapshot.forEach((doc) => { const data =
doc.data(); findName.innerHTML = 'Name : ' + data.Name; findAge.innerHTML = 'Age : ' + data.Age; }); } else { alert('No data found !'); } }) .catch((error) => {
console.log('Error getting documents: ', error); }); } async function handleUpdateBtn() { const IDValue = enterID.value; const NameValue = enterName.value;
const AgeValue = parseInt(enterAge.value); // make sure age is stored as a number try { const snapshot = await userRef.where('ID', '==', IDValue).get(); if
(!snapshot.empty) { snapshot.forEach((doc) => { doc.ref.update({ Name: NameValue, Age: AgeValue, }); }); console.log('Data successfully updated!'); } else {
console.log('No matching document found.'); } } catch (error) { console.error('Error updating the user:', error); } } async function handleRemoveBtn() { const
IDValue = enterID.value; try { const snapshot = await userRef.where('ID', '==', IDValue).get(); if (!snapshot.empty) { snapshot.forEach((doc) => {
doc.ref.delete(); }); console.log('Data successfully deleted!'); } else { console.log('No matching document found.'); } } catch (error) { console.error('Error
deleting the user:', error); } } insertBtn.addEventListener('click', handleInsertBtn); findBtn.addEventListener('click', handleFindBtn);
updateBtn.addEventListener('click', handleUpdateBtn); removeBtn.addEventListener('click', handleRemoveBtn); -->
